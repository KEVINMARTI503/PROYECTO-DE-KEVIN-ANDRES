--  2 ============================================================================
-- AGENDA DEL D√çA: PARTIDOS PROGRAMADOS POR LIGA Y ESTADIO
-- Enunciado: Muestra por liga los partidos con fecha = hoy, con equipos local/visitante,
-- estadio y hora. Ordena por liga, estadio y hora.





SELECT
    l.nombre AS liga,
    e_local.nombre AS equipo_local,
    e_visitante.nombre AS equipo_visitante,
    es.nombre AS estadio,
    p.hora
FROM
    ksanchez.partido p
JOIN
    ksanchez.equipo e_local ON p.id_equipo_local = e_local.id_equipo
JOIN
    ksanchez.equipo e_visitante ON p.id_equipo_visitante = e_visitante.id_equipo
JOIN
    ksanchez.estadio es ON p.id_estadio = es.id_estadio
JOIN
    ksanchez.liga l ON e_local.id_liga = l.id_liga -- Asume que la liga del equipo local es la liga del partido
WHERE
    p.fecha = CURRENT_DATE -- Filtra por la fecha actual del sistema (PostgreSQL)
ORDER BY
    liga, estadio, p.hora;
